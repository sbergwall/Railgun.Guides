# Installing Windows Admin Center (WAC)

> **Version Information**:  
> - Documentation based on Windows Admin Center 2410 (April 2024 Update)
> - Features and requirements may vary with newer versions
> - For the latest version, always check the [Microsoft Evaluation Center](https://www.microsoft.com/en-us/evalcenter/download-windows-admin-center)

This guide explains how to install and configure Windows Admin Center in a domain environment, following Microsoft's best practices for security and management.

## Prerequisites

### System Requirements
- **Operating System**: 
  - Windows Server 2019/2022/2025
  - Windows 10/11 Enterprise/Pro (version 1809 or later)
- **Memory**: 2 GB minimum, 8 GB recommended
- **CPU**: 1.4 GHz 64-bit processor
- **Disk Space**: 2 GB minimum
- **.NET Runtime**: .NET Framework 4.7.2 or later

### Network Requirements
- Static IP address
- DNS Server configuration
- Ports: 443 (HTTPS), 5985 (WinRM HTTP), 5986 (WinRM HTTPS)
- Internet connectivity for initial download and updates

### Security Requirements
- Administrative privileges on the installation machine
- Domain join capabilities
- SSL certificate (self-signed for testing, trusted CA cert for production)
- HTTPS binding
- WinRM configuration for remote management

## 1. Network Configuration
```powershell
$newIP = "192.168.2.15"
$defaultGateway = "192.168.2.1"
$InterfaceIndex = "6"
$clientName = "WAC01"
$dnsServerIP = "192.168.2.10"
$domainName = "company.pri"

Get-NetIPAddress -AddressFamily IPv4
New-NetIPAddress -InterfaceIndex $InterfaceIndex -IPAddress $newIP -PrefixLength 24 -DefaultGateway $defaultGateway
Set-DnsClientServerAddress -InterfaceIndex $InterfaceIndex -ServerAddresses ($dnsServerIP,"8.8.8.8")
```
Sets up static IP addressing and DNS configuration required for WAC server.

## 2. Server Preparation
```powershell
Rename-Computer $clientName -Restart
add-computer â€“domainname $domainName -restart
```
Renames the server and joins it to the domain. A restart will occur after each operation.

## 3. Windows Admin Center Installation

### Download and Install
```powershell
$tmpPath = "C:\tmp"
mkdir $tmpPath
$dlPath = Join-Path -Path $tmpPath -ChildPath "WAC.msi"
# Using the official Microsoft Evaluation Center download link
Invoke-WebRequest 'https://aka.ms/wacdownload' -OutFile $dlPath

$port = 443
msiexec /i $dlPath /qn /L*v log.txt SME_PORT=$port SSL_CERTIFICATE_OPTION=generate
```

The installation:
- Downloads the latest WAC version
- Installs WAC in quiet mode
- Configures HTTPS on port 443
- Generates a self-signed certificate (valid for 60 days)

> **Important**: For production environments, replace `SSL_CERTIFICATE_OPTION=generate` with your own trusted certificate.

## 4. Extension Installation
```powershell
Import-Module "$env:ProgramFiles\WindowsAdminCenter\PowerShellModules\Microsoft.WindowsAdminCenter.ExtensionTools"

$extensions = @(
    "msft.sme.active-directory",
    "msft.sme.cluster-creation",
    "msft.sme.software-defined-data-center",
    "msft.sme.dhcp",
    "msft.sme.dns",
    "msft.sme.failover-cluster",
    "msft.sme.file-explorer",
    "msft.iis.iis-management",
    "msft.sme.powershell-console",
    "msft.sme.remote-desktop",
    "microsoft.security",
    "msft.sme.storage",
    "msft.sme.storage-replica",
    "msft.sme.windows-update",
    "msft.sme.hyperv",
    "msft.sme.storage-migration"
)

$extensions | ForEach-Object {
    Install-Extension -GatewayEndpoint "https://$newIP" $_
}

# Update any extensions that aren't on the latest version
Get-Extension "https://$newIP" | 
    Where-Object {$_.isLatestVersion -eq $false} | 
    ForEach-Object {Update-Extension "https://$newIP" $_.id}
```
Installs and updates essential management extensions for WAC.

## 5. Kerberos Delegation Configuration
```powershell
# Configure Kerberos delegation from a DC 
Set-ADComputer -Identity (Get-ADComputer DC01) -PrincipalsAllowedToDelegateToAccount (Get-ADComputer $clientName)
```
Configures Kerberos delegation to allow WAC to manage domain resources.

## Post-Installation Tasks

1. Verify Installation:
   - Navigate to `https://WAC01` in a browser
   - Log in with domain admin credentials
   - Verify all extensions are installed and updated

2. Security Considerations:
   - Review and configure [Windows Admin Center RBAC](https://learn.microsoft.com/en-us/windows-server/manage/windows-admin-center/configure/user-access-control)
   - Install a trusted SSL certificate for production use
   - Configure backup of WAC settings
   - Enable auditing for WAC activities

3. Maintenance:
   - Monitor certificate expiration
   - Keep extensions updated
   - Review and update access permissions regularly
   - Configure automatic updates

> **Note**: Remember to replace the self-signed certificate with a trusted certificate before using in production.

## Troubleshooting

If you encounter issues:
1. Check the installation logs at `C:\Windows\Temp\WindowsAdminCenter`
2. Verify network connectivity and DNS resolution
3. Ensure all required ports are open (443 by default)
4. Verify Kerberos delegation settings
5. Check browser compatibility (Edge or Chrome recommended)
